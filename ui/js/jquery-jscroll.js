$.fn.extend({mousewheel:function(n){return this.each(function(){var o=this;o.D=0,$.browser.mozilla?o.addEventListener("DOMMouseScroll",function(t){o.D=t.detail>0?-1:1,t.preventDefault(),n&&n.call(o)},!1):o.onmousewheel=function(){o.D=event.wheelDelta,event.returnValue=!1,n&&n.call(o)}})}}),$.fn.extend({jscroll:function(n){return this.each(function(){n=n||{},n.Bar=n.Bar||{},n.Btn=n.Btn||{},n.Bar.Bg=n.Bar.Bg||{},n.Bar.Bd=n.Bar.Bd||{},n.Btn.uBg=n.Btn.uBg||{},n.Btn.dBg=n.Btn.dBg||{};var o={W:"15px",BgUrl:"",Bg:"#efefef",Bar:{Pos:"up",Bd:{Out:"#b5b5b5",Hover:"#ccc"},Bg:{Out:"#fff",Hover:"#fff",Focus:"orange"}},Btn:{btn:!0,uBg:{Out:"#ccc",Hover:"#fff",Focus:"orange"},dBg:{Out:"#ccc",Hover:"#fff",Focus:"orange"}},Fn:function(){}};n.W=n.W||o.W;var t=n.BarLimit||1e4;n.BgUrl=n.BgUrl||o.BgUrl,n.Bg=n.Bg||o.Bg,n.Bar.Pos=n.Bar.Pos||o.Bar.Pos,n.Bar.Bd.Out=n.Bar.Bd.Out||o.Bar.Bd.Out,n.Bar.Bd.Hover=n.Bar.Bd.Hover||o.Bar.Bd.Hover,n.Bar.Bg.Out=n.Bar.Bg.Out||o.Bar.Bg.Out,n.Bar.Bg.Hover=n.Bar.Bg.Hover||o.Bar.Bg.Hover,n.Bar.Bg.Focus=n.Bar.Bg.Focus||o.Bar.Bg.Focus,n.Btn.btn=void 0!=n.Btn.btn?n.Btn.btn:o.Btn.btn,n.Btn.uBg.Out=n.Btn.uBg.Out||o.Btn.uBg.Out,n.Btn.uBg.Hover=n.Btn.uBg.Hover||o.Btn.uBg.Hover,n.Btn.uBg.Focus=n.Btn.uBg.Focus||o.Btn.uBg.Focus,n.Btn.dBg.Out=n.Btn.dBg.Out||o.Btn.dBg.Out,n.Btn.dBg.Hover=n.Btn.dBg.Hover||o.Btn.dBg.Hover,n.Btn.dBg.Focus=n.Btn.dBg.Focus||o.Btn.dBg.Focus,n.Fn=n.Fn||o.Fn;var e,r=this,u=0,c=0;$(r).css({overflow:"hidden",position:"relative",padding:"0px"});var B=($(r).width(),$(r).height()-1),a=n.W?parseInt(n.W):21,s=1==n.Btn.btn?a:0;null==$(r).children(".jscroll-c").height()&&($(r).wrapInner("<div class='jscroll-c' style='top:0px;z-index:9999;zoom:1;position:relative'></div>"),$(r).children(".jscroll-c").prepend("<div style='height:0px;overflow:hidden'></div>"),$(r).append("<div class='jscroll-e' unselectable='on' style=' height:100%;top:0px;right:0;-moz-user-select:none;position:absolute;overflow:hidden;z-index:10000;'><div class='jscroll-u' style='position:absolute;top:0px;width:100%;left:0;background:blue;overflow:hidden'></div><div class='jscroll-h'  unselectable='on' style='cursor:pointer;background:green;position:absolute;left:0;-moz-user-select:none;'></div><div class='jscroll-d' style='position:absolute;bottom:0px;width:100%;left:0;background:blue;overflow:hidden'></div></div>"));var g=$(r).children(".jscroll-c"),d=$(r).children(".jscroll-e"),i=d.children(".jscroll-h"),l=d.children(".jscroll-u"),b=d.children(".jscroll-d");$.browser.msie&&document.execCommand("BackgroundImageCache",!1,!0),g.css({"padding-right":a}),d.css({width:a,background:n.Bg,"background-image":""}),i.css({top:s,left:"1px",background:n.Bar.Bg.Out,"background-image":n.BgUrl,width:a}),l.css({height:s,background:n.Btn.uBg.Out,"background-image":n.BgUrl}),b.css({height:s,background:n.Btn.dBg.Out,"background-image":n.BgUrl}),i.hover(function(){0==c&&$(this).css({background:n.Bar.Bg.Hover,"background-image":n.BgUrl,"border-color":n.Bar.Bd.Hover})},function(){0==c&&$(this).css({background:n.Bar.Bg.Out,"background-image":n.BgUrl,"border-color":n.Bar.Bd.Out})}),l.hover(function(){0==c&&$(this).css({background:n.Btn.uBg.Hover,"background-image":n.BgUrl})},function(){0==c&&$(this).css({background:n.Btn.uBg.Out,"background-image":n.BgUrl})}),b.hover(function(){0==c&&$(this).css({background:n.Btn.dBg.Hover,"background-image":n.BgUrl})},function(){0==c&&$(this).css({background:n.Btn.dBg.Out,"background-image":n.BgUrl})});var v=g.height(),h=(B-2*s)*B/v;10>h&&(h=10);var f=h/6;h=parseInt(h),h=n.H||h;var m=0,p=!1;i.height(h),B>=v?(g.css({padding:0}),d.css({display:"none"})):p=!0,"up"!=n.Bar.Pos&&(m=B-h-s,F()),i.bind("mousedown",function(o){n.Fn&&n.Fn.call(r),c=1,i.css({background:n.Bar.Bg.Focus,"background-image":n.BgUrl});var t=o.pageY,e=parseInt($(this).css("top"));return $(document).mousemove(function(n){m=e+n.pageY-t,F()}),$(document).mouseup(function(){c=0,i.css({background:n.Bar.Bg.Out,"background-image":n.BgUrl}),$(document).unbind()}),!1}),l.bind("mousedown",function(o){return n.Fn&&n.Fn.call(r),c=1,l.css({background:n.Btn.uBg.Focus,"background-image":n.BgUrl}),r.timeSetT("u"),$(document).mouseup(function(){c=0,l.css({background:n.Btn.uBg.Out,"background-image":n.BgUrl}),$(document).unbind(),clearTimeout(e),u=0}),!1}),b.bind("mousedown",function(o){return n.Fn&&n.Fn.call(r),c=1,b.css({background:n.Btn.dBg.Focus,"background-image":n.BgUrl}),r.timeSetT("d"),$(document).mouseup(function(){c=0,b.css({background:n.Btn.dBg.Out,"background-image":n.BgUrl}),$(document).unbind(),clearTimeout(e),u=0}),!1}),r.timeSetT=function(n){var o=this;"u"==n?m-=f:m+=f,F(),u+=2;var t=500-50*u;0>=t&&(t=0),e=setTimeout(function(){o.timeSetT(n)},t)},d.bind("mousedown",function(o){return n.Fn&&n.Fn.call(r),m=m+o.pageY-i.offset().top-h/2,k(),!1});var k=function(){s>m&&(m=s),m>B-h-s&&(m=B-h-s),i.stop().animate({top:m},100);var n=-((m-s)*v/(B-2*s));g.stop().animate({top:n},1e3)},F=function(){if(s>m&&(m=s),m>B-h-s&&(m=B-h-s),!(m>parseInt(t))){i.css({top:m});var n=-((m-s)*v/(B-2*s));g.css({top:n})}};$(r).mousewheel(function(){1==p&&(n.Fn&&n.Fn.call(r),this.D>0?m-=f:m+=f,F())})})}});