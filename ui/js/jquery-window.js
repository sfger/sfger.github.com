$.fn.window=function(t){var o=$.type(t);if("string"===o)return this.each(function(){var o=$(this).data("ui");if(!o||!o.iWindow)throw new Error("UI:window does not init...");o.iWindow[t]()}),!0;t=$.extend(!0,{title:"",show:!1,footer:{}},t);var e=function(t,o){return new e.prototype.init(t,o)};return e.prototype={init:function(t,o){var e=this,i=$(t),n=o.footer.formatter?'<div class="window-bar window-footer">'+o.footer.formatter()+"</div>":"",s='<div class="window-ctn"><div class="window-wrapper"><div class="window-bar window-header"><div class="window-title">'+(o.title||"")+'</div><a href="javascript:;" class="window-closer">&times;</a><!--[if lt IE 8]><p class="iecp"></p><![endif]--></div><div class="window-contents"></div>'+n+'</div><!--[if lt IE 8]><p class="iecp"></p><![endif]--></div>',r=$(s.replace(/(\/?>)\s+|\s+(?=<)/g,"$1")).appendTo(document.body);o["class"]&&r.addClass(o["class"]),o.id&&r.attr("id",o.id),this.userOptions=o,this.container=r.get(0),this.render=t,this.wraper=$(".window-wrapper",r).get(0),this.closer=$(".window-closer",r).get(0),this.contents=$(".window-contents",r).get(0),this.title=$(".window-title",r).html(o.title).get(0),i.addClass("window-view").appendTo(this.contents).show(),$(["Height","Width"]).each(function(t,o){e["getView"+o]=function(){var t="BackCompat"===document.compatMode?document.body:document.documentElement;return function(){return t["client"+o]}}(),e["getElement"+o]=function(t){return t&&"none"!==t.style.display?t["offset"+o]:0}}),$(this.closer).on("click",function(){return e.close(),!1}),o.show&&this.show(),o.onCreate&&"function"==typeof o.onCreate&&o.onCreate()},resize:function(){var t=$(this.container);t.is(":visible")&&t.css({width:this.getViewWidth(),height:this.getViewHeight()})},open:function(){this.show()},show:function(){var t=$(this.container);if(t.is(":visible"))return!1;var o=this.userOptions;if(o.onBeforeOpen&&!o.onBeforeOpen())return!1;t.fadeIn(150);var e="CSS1Compat"===document.compatMode,i=/MSIE 6.0/.exec(navigator.userAgent);return!i&&e||(t.css({height:this.getViewHeight(),position:"absolute"}),$(window).on("scroll.windowIE6",{el:this.container},this.scrollIE6),$(window).trigger("scroll.windowIE6")),o.onOpen&&o.onOpen(),this},scrollIE6:function(t){var o=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop;$(t.data.el).css({top:o})},close:function(){var t=this.userOptions;return!(t.onBeforeClose&&"function"==typeof t.onClose&&!t.onBeforeClose())&&($(this.container).fadeOut(150),$(window).off("scroll.windowIE6",this.scrollIE6),t.onClose&&"function"==typeof t.onClose&&t.onClose(),this)}},e.prototype.init.prototype=e.prototype,this.each(function(){var o=$(this),i=e(this,$.extend(!0,{},t)),n=o.data("ui");n?n.iWindow=i:o.data("ui",{iWindow:i})})};