$.fn.window=function(t){if("string"===$.type(t))return this.each(function(){var e=$(this).data("ui");if(!e||!e.iWindow)throw new Error("UI:window does not init...");e.iWindow[t]()}),!0;t=$.extend(!0,{"title":"","show":!1,"footer":{}},t);var e=function(t,o){return new e.prototype.init(t,o)};return e.prototype={"init":function(t,e){var o=this,i=$(t),n=e.footer.formatter?'<div class="window-bar window-footer">'+e.footer.formatter()+"</div>":"",s='<div class="window-ctn"><div class="window-wrapper"><div class="window-bar window-header"><div class="window-title">'+(e.title||"")+'</div><a href="javascript:;" class="window-closer">&times;</a>\x3c!--[if lt IE 8]><p class="iecp"></p><![endif]--\x3e</div><div class="window-contents"></div>'+n+'</div>\x3c!--[if lt IE 8]><p class="iecp"></p><![endif]--\x3e</div>',r=$(s.replace(/(\/?>)\s+|\s+(?=<)/g,"$1")).appendTo(document.body);e["class"]&&r.addClass(e["class"]),e.id&&r.attr("id",e.id),this.userOptions=e,this.container=r.get(0),this.render=t,this.wraper=$(".window-wrapper",r).get(0),this.closer=$(".window-closer",r).get(0),this.contents=$(".window-contents",r).get(0),this.title=$(".window-title",r).html(e.title).get(0),i.addClass("window-view").appendTo(this.contents).show(),$(["Height","Width"]).each(function(t,e){o["getView"+e]=function(){var t="BackCompat"===document.compatMode?document.body:document.documentElement;return function(){return t["client"+e]}}(),o["getElement"+e]=function(t){return t&&"none"!==t.style.display?t["offset"+e]:0}}),$(this.closer).on("click",function(){return o.close(),!1}),e.show&&this.show(),e.onCreate&&"function"===typeof e.onCreate&&e.onCreate()},"resize":function(){var t=$(this.container);t.is(":visible")&&t.css({"width":this.getViewWidth(),"height":this.getViewHeight()})},"open":function(){this.show()},"show":function(){var t=$(this.container);if(t.is(":visible"))return!1;var e=this.userOptions;if(e.onBeforeOpen&&!e.onBeforeOpen())return!1;t.fadeIn(150);var o="CSS1Compat"===document.compatMode;return!/MSIE 6.0/.exec(navigator.userAgent)&&o||(t.css({"height":this.getViewHeight(),"position":"absolute"}),$(window).on("scroll.windowIE6",{"el":this.container},this.scrollIE6),$(window).trigger("scroll.windowIE6")),e.onOpen&&e.onOpen(),this},"scrollIE6":function(t){var e=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop;$(t.data.el).css({"top":e})},"close":function(){var t=this.userOptions;return!(t.onBeforeClose&&"function"===typeof t.onClose&&!t.onBeforeClose())&&($(this.container).fadeOut(150),$(window).off("scroll.windowIE6",this.scrollIE6),t.onClose&&"function"===typeof t.onClose&&t.onClose(),this)}},e.prototype.init.prototype=e.prototype,this.each(function(){var o=$(this),i=e(this,$.extend(!0,{},t)),n=o.data("ui");n?n.iWindow=i:o.data("ui",{"iWindow":i})})};