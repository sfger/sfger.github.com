$.fn.pagination=function(e){var t=$.type(e);if("string"===t){var a=Array.prototype.slice.call(arguments).slice(1);return this.each(function(){var t=$(this).data("ui");if(!t||!t.iPagination)throw new Error("UI:window does not init...");t.iPagination[e].apply(t.iPagination,a)}),!0}e=$.extend(!0,{useAjax:!1,dataSize:0,show:5,pageSize:25,pageNumber:null,pageNumberQueryName:"pageNumber",pageNumberReg:null,pageNumberParser:function(){return this.pageNumberReg=new RegExp("([?&]{1}"+this.pageNumberQueryName+"=)([^&]*)")},pageNumberGetter:function(e){this.pageNumberReg||this.pageNumberParser(),e=e||location.href;var t=this.pageNumberReg.exec(e);return t&&t[2]&&(t=t[2]),parseInt(t,10)||1},pageNumberSetter:function(e,t){e=e||location.href,"?"==e.slice(-1)&&(e=e.slice(0,-1)),t=t||"";var a="",i=document.createElement("a");return i.href=e,a=this.pageNumberReg.test(e)?e.replace(this.pageNumberReg,"$1"+t):e+(i.search?"&":"?")+this.pageNumberQueryName+"="+t},showPreNext:!0,showPreNextOnEdge:!0,prePageAlias:"上一页",nextPageAlias:"下一页",pageSizeList:[10,25,50,100]},e);var i=function(e,t){return new i.prototype.init(e,t)};return i.prototype={render:null,pageCount:1,init:function(e,t){this.userOptions=t;var a=t.render;this.pageCount=Math.ceil(t.dataSize/t.pageSize),this.pageCount=this.pageCount<1?1:this.pageCount,$(a).addClass("pagination-ctn");var i,n;i=t.pageNumber,t.useAjax?n="javascript:":(i=t.pageNumberGetter(location.href),n=t.pageNumberSetter(location.href)),i=i>this.pageCount?this.pageCount:i,t.pageNumber=i,this.url=n,this.update(i,t.dataSize),this.initEvent()},update:function(e,t){var a=this.userOptions;!isNaN(t)&&Number(t)>=0&&(a.dataSize=t,this.pageCount=Math.ceil(a.dataSize/a.pageSize)||1),$(a.render).html(this.navishow(e,this.pageCount,this.url,a.show)+'&nbsp;<div class="form"><span>第</span><input name="'+a.pageNumberQueryName+'" class="page" type="text" value="" /><a href="javascript:" class="go">GO</a><span>页</span></div>&nbsp;<div class="desc">共<span class="dataSize">'+a.dataSize+"</span>条记录</div>")},initEvent:function(){var e=this,t=this.userOptions,a=t.render;$(a).on({keyup:function(t){if(-1!=$.inArray(t.keyCode,[8,37,39]))return!0;var a=parseInt(this.value,10)||1;return a>1&&40===t.keyCode&&--a,a<e.pageCount&&38===t.keyCode&&++a,a<1&&(a=1),a>e.pageCount&&(a=e.pageCount),this.value=a,!1}},".page"),$(a).on("click",".go",function(){var i=$(".page",a).val();return!(!i||isNaN(i))&&(i=i>e.pageCount?e.pageCount:i<1?1:i,t.useAjax?(t.pageNumber=Number(i),t.onChangePage&&t.onChangePage.call(e,t.pageNumber,e.pageCount),e.update(t.pageNumber)):location.href=t.pageNumberSetter(location.href,i),!1)}),t.useAjax&&$(a).on("click",".pn:not(.disabled)",function(){t.pageNumber=Number(this.getAttribute("pageNumber")),t.onChangePage&&t.onChangePage.call(e,t.pageNumber,e.pageCount),e.update(t.pageNumber)})},getNaviNode:function(e,t,a){var i=this.userOptions;i.useAjax||(e=i.pageNumberSetter(e,t));var n=function(){return a===i.prePageAlias?" prev":a===i.nextPageAlias?" next":""}();return(t<1||t>this.pageCount)&&(n+=" disabled"),e='<a href="'+(t>0&&t<=this.pageCount?e:"javascript:")+'" pageNumber="'+t+'" class="pn'+n+'">'+a+"</a>"},getPlainChild:function(e){return'<a href="javascript:" class="'+("..."===e?"plain":"current")+'">'+e+"</a>"},navishow:function(e,t,a,i){i=void 0==i?11:i;var n=Math.floor(i/2),r=0,s='<div class="pc">',o=this.userOptions;if((o.showPreNextOnEdge||o.showPreNext&&e>1)&&(s+=this.getNaviNode(a,e-1,o.prePageAlias||"上一页")),t<=i)for(r=1;r<=t;r++)s+=r==e?this.getPlainChild(r):this.getNaviNode(a,r,r);else{if(e-2<n+2)for(r=1;r<=e;r++)s+=r==e?this.getPlainChild(r):this.getNaviNode(a,r,r);else for(s+=this.getNaviNode(a,1,1),t!=i+1&&(s+=this.getPlainChild("...")),r=e-n+(t-e-n>0?0:t-e-n);r<=e;r++)s+=r==e?this.getPlainChild(r):this.getNaviNode(a,r,r);if(t-e<n+3)for(r=e+1;r<=t;r++)s+=r==e?this.getPlainChild(r):this.getNaviNode(a,r,r);else{for(e=parseInt(e,10),r=e+1;r<=e+n-(e-n>1?0:e-n-1);r++)s+=r==e?this.getPlainChild(r):this.getNaviNode(a,r,r);t!=i+1&&(s+=this.getPlainChild("...")),s+=this.getNaviNode(a,t,t)}}return(o.showPreNextOnEdge||o.showPreNext&&e!=t)&&(s+=this.getNaviNode(a,e+1,o.nextPageAlias||"下一页")),s+"</div>"}},i.prototype.init.prototype=i.prototype,this.each(function(){var t=$(this),a=i(this,$.extend(!0,{render:this},e)),n=t.data("ui");n?n.iPagination=a:t.data("ui",{iPagination:a})})};