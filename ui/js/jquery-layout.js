$.fn.layout=function(t){var e=$.type(t);if("string"===e)return this.each(function(){var e=$(this).data("ui");if(!e||!e.iLayout)throw new Error("UI:layout does not init...");e.iLayout[t]()}),!0;t=$.extend(!0,{panel:{toggle:!0,resize:!0,each:{north:{toggle:!1,resize:!1},south:{toggle:!1,resize:!1},west:{toggle:!0,resize:!0},east:{toggle:!0,resize:!0}}},panelBar:{size:5,each:{north:{},south:{},west:{},east:{}}}},t);var s=function(t,e){return new s.prototype.init(t,e)};return s.prototype={init:function(t,e){this.box=t,$(t).addClass("layout-container"),this.userOptions=e,this.panels={north:$(">.layout-north",t).get(0),south:$(">.layout-south",t).get(0),west:$(">.layout-middle-container>.layout-west",t).get(0),east:$(">.layout-middle-container>.layout-east",t).get(0),center:$(">.layout-middle-container>.layout-center",t).get(0)};var s=e.panelBar,o=s.each,i=s.size;this.panelBars={north:$(".bar-north",t).css({height:o.north.height||i}).get(0),south:$(".bar-south",t).css({height:o.south.height||i}).get(0),west:$(">.layout-middle-container>.bar-west",t).css({width:o.west.width||i}).get(0),east:$(">.layout-middle-container>.bar-east",t).css({width:o.east.width||i}).get(0)};var a=this;$(["Height","Width"]).each(function(t,e){a["getView"+e]=function(){var t="BackCompat"===document.compatMode?document.body:document.documentElement;return function(){return t["client"+e]}}(),a["getElement"+e]=function(t){return t&&"none"!==t.style.display?t["offset"+e]:0}}),e.panel.resize&&this.panelResize(),e.panel.toggle&&this.init_toggle(),$(window).resize(function(){a.resize()}),this.resize()},disableSelection:function(){window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},panelResize:function(){var t=this.box,e=this;$(">.resize-bar,>.layout-middle-container>.resize-bar",t).on({mousedown:function(s){if($(s.target).hasClass("ib-col"))return!1;var o=e.userOptions.panel.each,i=this,a=$(i);if(a.hasClass("bar-north")&&o.north.resize===!1||a.hasClass("bar-south")&&o.south.resize===!1||a.hasClass("bar-west")&&o.west.resize===!1||a.hasClass("bar-east")&&o.east.resize===!1)return!1;var n=a.hasClass("bar-south")?a.next():a.prev();n.is(":visible")||n.show();var h=t.cover?$(t.cover).show():$("<div></div>").appendTo(document.body);t.cover=h.get(0),h.css({position:"absolute",opacity:.1,filter:"alpha(opacity=10)",background:"white",zIndex:50,top:0,left:0,width:e.getElementWidth(e.box),height:e.getElementHeight(e.box)});var r=this.proxy?$(this.proxy).show():$(this).clone().html("").appendTo(document.body);this.proxy=r.get(0),r.css({position:"absolute",opacity:.5,filter:"alpha(opacity=50)",zIndex:100,width:this.offsetWidth,height:this.offsetHeight,top:$(this).position().top,left:$(this).position().left,background:"black"});var l={mousemove:function(t){return e.disableSelection(),r.hasClass("bar-east")||r.hasClass("bar-west")?r.css({left:t.pageX}):r.css({top:t.pageY}),!1},mouseup:function(s){$([i.proxy,t.cover]).hide();var o=s.pageX,h=s.pageY,r=e.box.getBoundingClientRect();o-=r.left,h-=r.top;var u=e.userOptions.panelBar.size,c=e.userOptions.panelBar.each;return a.hasClass("bar-west")?n.css({width:o}):a.hasClass("bar-east")?n.css({width:e.getElementWidth(e.box)-o-(c.east.width||u)}):a.hasClass("bar-north")?n.css({height:h}):a.hasClass("bar-south")&&n.css({height:e.getElementHeight(e.box)-h-(c.south.height||u)}),$(document).off("mousemove",l.mousemove),$(document).off("mouseup",l.mouseup),$(window).trigger("resize"),!1}};$(document).on(l)}})},init_toggle:function(){var t=this;$(">.layout-middle-container>.resize-bar .ib-col, >.resize-bar .ib-col",this.box).click(function(){return t.panelToggle($(this).parent()),!1})},panelToggle:function(t){var e=t.hasClass("bar-south")?t.next():t.prev(),s=this.userOptions.panel.each;if(t.hasClass("bar-north")&&s.north.toggle===!1||t.hasClass("bar-south")&&s.south.toggle===!1||t.hasClass("bar-west")&&s.west.toggle===!1||t.hasClass("bar-east")&&s.east.toggle===!1)return!1;var o=e.get(0).style;"none"!==o.display?(e.width("0px"),e.hide()):(t.get(0).style.cursor="","0px"===o.width&&(o.width=""),"0px"===o.height&&(o.height=""),e.show()),this.resize()},resize:function(){var t=this.getElementHeight,e=this.panels,s=this.panelBars,o=/MSIE 6/,i=document.documentMode,a=this.getElementHeight(this.box)-t(e.north)-t(e.south)-t(s.north)-t(s.south);if($(">.layout-middle-container",this.box).height(a),5===i||o.test(navigator.userAgent)){var n=this.getElementWidth,h=this.getElementWidth(this.box)-n(e.west)-n(e.east)-n(s.west)-n(s.east);$(">.layout-middle-container>.layout-center",this.box).css({width:h,height:a}),$(">.layout-middle-container>div",this.box).height(a)}}},s.prototype.init.prototype=s.prototype,this.each(function(){var e=$(this),o=s(this,$.extend(!0,{},t)),i=e.data("ui");i?i.iLayout=o:e.data("ui",{iLayout:o})})};