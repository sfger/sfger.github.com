$.fn.tabs=function(e){var t=$.type(e);if("string"===t){var i=Array.prototype.slice.call(arguments).slice(1);return this.each(function(){var t=$(this).data("ui");if(!t||!t.iTab)throw new Error("UI:tabs does not init...");t.iTab[e].apply(t.iTab,i)}),!0}e=$.extend(!0,{height:80,tabWidth:160,contentFit:!1,eventType:"click",border:!0,icon:null,selected:0,position:"north"},e);var n=Array.prototype.slice,s=Object.prototype.toString,r=function(e){return s.call(e).slice(8,-1)},a=function(e){var t="",i=[],n=null,s=null,h=a,l=r(e);if("Array"===l)for(var c in e)t+=h(e[c]);else if("String"===l||"Number"==l)t=e;else if("Object"===l&&e.name){if(n=e.attr,s=e.children,i=[],n)for(var o in n)if("className"!=o){if("style"==o){var d=n[o],p=r(d);if(n[o]="","Object"==p)for(var f in d)n[o]+=f+":"+d[f]+";";else"String"==p&&(n[o]=d)}i.push(""+o+'="'+n[o]+'"')}else i.push('class="'+n[o]+'"');i.length&&i.unshift(""),s&&"Array"!==r(s)&&(s=[s]),t="<"+e.name+i.join(" ")+">"+(s?h(s):"")+"</"+e.name+">"}else t="";return t},h=function(e){var t=[];try{t=n.call(e)}catch(i){for(var s=0,r=e.length-1;s<=r;s++)t.push(e[s])}return t};Array.prototype.indexOf=Array.prototype.indexOf||function(e,t){return $.inArray(e,this,t)},e.renders=n.call(this);var l=function(e,t){return new l.prototype.init(e,t)};return l.prototype={init:function(e,t){this.render=e,this.userOptions=t,this.headers=$(e.children[0].children).toArray(),this.panels=$(e.children[1].children).toArray(),$(this.panels).addClass("tab-content");var i=this,n=$(e);if(n.addClass("tab-ctn"),this.headers.length&&($(this.headers[t.selected]).addClass("current"),$(this.panels).parent().show().end().hide().eq(t.selected).show()),t.contentFit){var s=e.children[1].offsetHeight-e.children[1].clientHeight,r=e.parentNode;$(window).on("resize.tab-content-fit",function(){$(e.children[1]).css({height:r.clientHeight-s-e.children[0].offsetHeight+"px"})}).resize()}$(e.children[0]).on({click:function(){i.select(i.headers.indexOf(this))}},"li").on({click:function(){return i.close(i.headers.indexOf(this.parentNode.parentNode)),!1}},".closer")},add:function(t,i){var n=this.render,s=this.headers.length,r="before";void 0===i&&(i=s),i<0&&(i=0),s?i>=s&&(i=s,r="after"):(i=0,$(n.children[1]).show());var l=a({name:"li",children:{name:"a",attr:{href:"javascript:"},children:function(){var e=['<!--[if lt IE 8]><p class="iecp"></p><![endif]-->','<span class="title">'+t.title+"</span>"];return t.icon&&e.unshift(a({name:"span",attr:{className:"icon icon-"+t.icon}})),t.closable&&e.push(a({name:"span",attr:{className:"closer"},children:"&times;"})),e}()}}),c=$(a({name:"div",attr:{className:"tab-content",style:{display:"none"}}}));if(this.headers.length){var o="after"===r?i-1:i;$(this.headers[o])[r](l),$(this.panels[o])[r](c.append(t.content))}else $(n.children[0]).html(l),$(n.children[1]).html(c.append(t.content));this.headers=h(n.children[0].children),this.panels=h(n.children[1].children),i<=this.userOptions.selected&&this.userOptions.selected++,t.select&&this.select(i);var d=this.render;return e.contentFit&&(d.children[1].style.height=d.parentNode.offsetHeight-d.children[0].offsetHeight-1+"px"),this},remove:function(e){this.close(e)},close:function(e){var t=this.headers.splice(e,1)[0],i=this.panels.splice(e,1)[0];t.parentNode.removeChild(t),i.parentNode.removeChild(i);var n=this.userOptions;return n.selected==e?this.headers.length?this.select(e-1>0?e-1:0):n.selected=null:n.selected>e&&n.selected--,this},select:function(e){var t=this.userOptions.selected;return!(e<0||e>this.headers.length-1)&&($(this.headers[t]).removeClass("current"),$(this.headers[e]).addClass("current"),$(this.panels[t]).hide(),$(this.panels[e]).show(),this.userOptions.selected=e,this.userOptions.onSelect&&this.userOptions.onSelect(this.panels[e],e),this)}},l.prototype.init.prototype=l.prototype,this.each(function(){var t=$(this),i=l(this,$.extend(!0,{},e)),n=t.data("ui");n?n.iTab=i:t.data("ui",{iTab:i})})};