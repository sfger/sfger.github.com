!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["jquery","date-helper"],t):"object"==typeof exports?module.exports=t():t(jQuery)}(this,function(e,t){e.fn.datePicker=function(i){var d=e.extend(!0,{monthNum:1,proxy:e("body"),onComplete:function(){}},i),a='<div class="dtp-ctn"><a href="javascript:" class="dtp-switcher dtp-prev">&lt;</a><a href="javascript:" class="dtp-switcher dtp-next">&gt;</a><div class="dtp-header"><ul class="cf"><li></li></ul></div><div class="dtp-list cf"><div class="dtp-item"><ul class="dtp-wh cf"><li class="item day weekend">日</li><li class="item day">一</li><li class="item day">二</li><li class="item day">三</li><li class="item day">四</li><li class="item day">五</li><li class="item day weekend">六</li></ul><ul class="dtp-wd cf"></ul></div></div></div>',s=function(i,s,n){s=void 0!==s?s:!0;var o,r=e(a);if(d.monthNum>1){var l=r.find(".dtp-header ul"),c=r.find(".dtp-list");for(o=0;o<d.monthNum-1;o++)l.append(l.find("li").eq(0).clone()),c.append(c.find(".dtp-item").eq(0).clone())}var u=t();for(u.set_date(i),o=0;o<d.monthNum;o++){var p,f=u.current_date;if(d.minDate)switch(typeof d.minDate){case"string":p=d.minDate;break;case"function":p=d.minDate()}for(var h=u.get_first_date_of_month(),m=h.php_date("w"),v=h.php_date("t"),_=1,k="",y=0;42>y;y++){var b="",g=h.php_date("Y-m-"+t.pad(_,2));p>g?b=' class="disabled"':m>y||_>v?b=' class="disabled"':(g==f&&s||n&&g==n.value)&&(b=' class="selected"');var w=m>y||_>v?t.date("j",h.current_timestamp+86400*(-m+y)):_++;k+="<li"+b+">"+w+"</li>"}e(".dtp-header li",r).eq(o).html('<a href="javascript:;">'+h.php_date("Y")+'</a>年<a href="javascript:;">'+h.php_date("n")+"</a>月"),e(".dtp-wd",r).eq(o).append(k),e(".dtp-item",r).eq(0).css({borderColor:"white"}),n&&n.ui&&n.ui.renderTo?n.ui.renderTo.innerHTML=r.html():r.appendTo("body"),u.get_offset_date(1,"m")}return r.get(0)};return this.each(function(){var i=this,a=this.value;this.ui={hovered:!1,skipdate:a,renderTo:s(a)},e(this.ui.renderTo).css({position:"absolute",left:e(i).position().left,top:e(i).position().top+i.offsetHeight}),e(this.ui.renderTo).on({click:function(){i.ui.skipdate=t(i.ui.skipdate).get_offset_date(-Number(d.monthNum),"m").current_date,s(i.ui.skipdate,!1,i)}},".dtp-prev").on({click:function(){i.ui.skipdate=t(i.ui.skipdate).get_offset_date(Number(d.monthNum),"m").current_date,s(i.ui.skipdate,!1,i)}},".dtp-next").on({click:function(){i.value=t(i.ui.skipdate).get_first_date_of_month().get_offset_date(e(this).closest(".dtp-item").index(),"m").get_offset_date(Number(this.innerHTML-1)).current_date,e(i.ui.renderTo).hide(),d.onComplete&&d.onComplete.call(i,i.value)}},'.dtp-wd li:not(".disabled")').on({"mouseenter click":function(){i.ui.hovered=!0},mouseleave:function(){i.ui.hovered=!1}}),e(this).on({"click focus":function(){d.proxy.trigger("click"),s(i.value,!1,i),this.ui.hovered=!0,this.ui.skipdate=this.value,e(this.ui.renderTo).show()},blur:function(){this.ui.hovered=!1}}),e(this).next().on({click:function(){return e(i.ui.renderTo).show(),i.ui.hovered=!0,!1}}),d.proxy.on({click:function(){i.ui.hovered||e(i.ui.renderTo).hide()}})})}});